{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{JACw:function(n,l,e){\"use strict\";e.r(l);var t=e(\"CcnG\"),o=e(\"lGQG\"),i=e(\"JHBR\"),u=e(\"tct4\"),r=e(\"2WpN\"),a=e(\"ZZ/e\"),c=function(){return(c=Object.assign||function(n){for(var l,e=1,t=arguments.length;e<t;e++)for(var o in l=arguments[e])Object.prototype.hasOwnProperty.call(l,o)&&(n[o]=l[o]);return n}).apply(this,arguments)},s=function(n,l,e,t){return new(e||(e=Promise))(function(o,i){function u(n){try{a(t.next(n))}catch(l){i(l)}}function r(n){try{a(t.throw(n))}catch(l){i(l)}}function a(n){n.done?o(n.value):new e(function(l){l(n.value)}).then(u,r)}a((t=t.apply(n,l||[])).next())})},p=function(n,l){var e,t,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(e)throw new TypeError(\"Generator is already executing.\");for(;u;)try{if(e=1,t&&(o=2&i[0]?t.return:i[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,t=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=l.call(n,u)}catch(r){i=[6,r],t=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}},b=function(){function n(n,l,e,t){var o=this;this.afStorage=n,this.afs=l,this.alertController=e,this.loadingController=t,this.files=[],this.filesCollection=this.afs.collection(\"files\"),this.filesCollection.snapshotChanges().subscribe(function(n){for(var l=[],e=0,t=n;e<t.length;e++){var i=t[e],u=c({},i.payload.doc.data());u.id=i.payload.doc.id,l.push(u)}o.files=l,console.log(\"this.files\",o.files)})}return n.prototype.uploadFile=function(n,l,e){return void 0===e&&(e=\"filecabinet\"),s(this,void 0,void 0,function(){var t,o,i,u,a=this;return p(this,function(c){switch(c.label){case 0:return console.log(\"[uploadFile]\",n),console.log(\"-path\",e),o=this.afStorage.ref(t=e+\"/\"+n.name),i=this,[4,this.loadingController.create({message:\"Please wait...\",spinner:\"crescent\"})];case 1:return i.loading=c.sent(),this.loading.present(),(u=this.afStorage.upload(t,n)).percentageChanges(),u.snapshotChanges().pipe(Object(r.a)(function(){return s(a,void 0,void 0,function(){var i=this;return p(this,function(u){return console.log(\"-finalize\",e),o.getDownloadURL().subscribe(function(e){i.filesCollection.add({name:n.name,path:t,downloadURL:e,group:l}).then(function(n){i.loading.dismiss()}).catch(function(n){console.log(\"err\",n)})}),[2]})})})).subscribe(function(n){console.log(\"afUploadTask\",n)}),[2]}})})},n.prototype.downloadFile=function(n){console.log(\"[downloadFile]\",n);var l=document.createElement(\"a\");l.href=n.downloadURL,l.setAttribute(\"download\",name),l.click()},n.prototype.deleteFile=function(n){return s(this,void 0,void 0,function(){return p(this,function(l){return console.log(\"[deleteFile]\",n),this.filesCollection.doc(n.id).delete(),this.afStorage.ref(n.path).delete(),[2]})})},n.ngInjectableDef=t.S({factory:function(){return new n(t.W(i.a),t.W(u.a),t.W(a.a),t.W(a.Fb))},token:n,providedIn:\"root\"}),n}(),f=e(\"EVdn\"),d=e(\"l3hs\"),h=function(){function n(n,l,e,t,o){this.authService=n,this.afStorage=l,this.storageService=e,this.searchService=t,this.alertController=o,this.groups=[\"admin\",\"operations\",\"marketing\",\"camps\",\"showall\"],this.selectedDepartment=\"showall\",this.files=[],this.loadGapi().then(function(n){console.log(n)})}return n.prototype.ngOnInit=function(){},n.prototype.upload=function(){var n=this;f(\".hidden-input\").click(),f(\".hidden-input\").change(function(l){l.stopImmediatePropagation();var e=l.target.files[0];console.log('The file \"'+e.name+'\" has been selected.'),n.storageService.uploadFile(e,n.selectedDepartment)})},n.prototype.loadGapi=function(){return new Promise(function(n,l){gapi.load(\"client:auth2\",function(l){gapi.client.init({apiKey:\"AIzaSyBO3-f5lc3BYJGBNdlYaEz0odwcxefP0Yc\",clientId:\"694548309780-p7pvh160hh62p2dpma7822pv83hsd1js.apps.googleusercontent.com\",scope:\"https://www.googleapis.com/auth/drive\",discoveryDocs:[\"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\",\"https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest\"]}).then(function(){n(gapi);var l=gapi.auth2.getAuthInstance();console.log(\"gAuth\",l),console.log(\"gapi\",gapi);var e=gapi.client.drive.files.list();console.log(\"test \",e),l.isSignedIn.listen(function(n){console.log(\"listen gapi\",n)})})})})},n.prototype.onClickDownload=function(n,l){this.storageService.downloadFile(n)},n.prototype.onClickDelete=function(n,l){return e=this,void 0,o=function(){var l=this;return function(n,l){var e,t,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(e)throw new TypeError(\"Generator is already executing.\");for(;u;)try{if(e=1,t&&(o=2&i[0]?t.return:i[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,t=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=l.call(n,u)}catch(r){i=[6,r],t=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}}(this,function(e){switch(e.label){case 0:return[4,this.alertController.create({header:\"File Delete\",message:\"Are you sure <strong>delete</strong>!!!\",buttons:[{text:\"No\",role:\"cancel\",cssClass:\"secondary\",handler:function(n){}},{text:\"Yes\",handler:function(){l.storageService.deleteFile(n)}}]})];case 1:return[4,e.sent().present()];case 2:return e.sent(),[2]}})},new((t=void 0)||(t=Promise))(function(n,l){function i(n){try{r(o.next(n))}catch(e){l(e)}}function u(n){try{r(o.throw(n))}catch(e){l(e)}}function r(l){l.done?n(l.value):new t(function(n){n(l.value)}).then(i,u)}r((o=o.apply(e,[])).next())});var e,t,o},n.prototype.filterDownloadListByGroup=function(){},n}(),g=function(){return function(){}}(),v=e(\"pMnS\"),m=e(\"oBZk\"),w=e(\"Ip0R\"),y=e(\"gIcY\"),k=t.nb({encapsulation:0,styles:[[\".upload-fab[_ngcontent-%COMP%]{position:fixed;right:45px;bottom:15px;--background:var(--ion-color-secondary)}.download-btn[_ngcontent-%COMP%]{--background:var(--green)}.delete-btn[_ngcontent-%COMP%]{--background:var(--red)}.filter-row[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;margin-bottom:18px}.filter-select[_ngcontent-%COMP%]{background:var(--blue);color:var(--ion-color-light);margin-left:16px;min-width:140px}.filter-icon[_ngcontent-%COMP%]{width:18px;height:18px;margin-right:8px}\"]],data:{}});function x(n){return t.Jb(0,[(n()(),t.pb(0,0,null,null,3,\"ion-select-option\",[],null,null,null,m.eb,m.y)),t.ob(1,49152,null,0,a.nb,[t.h,t.k],{value:[0,\"value\"]},null),(n()(),t.Hb(2,0,[\"\",\"\"])),t.Db(3,1)],function(n,l){n(l,1,0,t.rb(1,\"\",l.context.$implicit,\"\"))},function(n,l){var e=t.Ib(l,2,0,n(l,3,0,t.zb(l.parent,0),l.context.$implicit));n(l,2,0,e)})}function C(n){return t.Jb(0,[(n()(),t.pb(0,0,null,null,12,\"ion-item\",[],null,null,null,m.X,m.q)),t.ob(1,49152,null,0,a.H,[t.h,t.k],null,null),(n()(),t.pb(2,0,null,0,2,\"ion-label\",[],null,null,null,m.Y,m.r)),t.ob(3,49152,null,0,a.N,[t.h,t.k],null,null),(n()(),t.Hb(4,0,[\"\",\"\"])),(n()(),t.pb(5,0,null,0,3,\"ion-button\",[[\"class\",\"download-btn\"]],null,[[null,\"click\"]],function(n,l,e){var t=!0;return\"click\"===l&&(t=!1!==n.component.onClickDownload(n.parent.context.$implicit,e)&&t),t},m.I,m.b)),t.ob(6,49152,null,0,a.k,[t.h,t.k],null,null),(n()(),t.pb(7,0,null,0,1,\"ion-icon\",[[\"name\",\"download\"]],null,null,null,m.V,m.o)),t.ob(8,49152,null,0,a.C,[t.h,t.k],{name:[0,\"name\"]},null),(n()(),t.pb(9,0,null,0,3,\"ion-button\",[[\"class\",\"delete-btn\"]],null,[[null,\"click\"]],function(n,l,e){var t=!0;return\"click\"===l&&(t=!1!==n.component.onClickDelete(n.parent.context.$implicit,e)&&t),t},m.I,m.b)),t.ob(10,49152,null,0,a.k,[t.h,t.k],null,null),(n()(),t.pb(11,0,null,0,1,\"ion-icon\",[[\"name\",\"close\"]],null,null,null,m.V,m.o)),t.ob(12,49152,null,0,a.C,[t.h,t.k],{name:[0,\"name\"]},null)],function(n,l){n(l,8,0,\"download\"),n(l,12,0,\"close\")},function(n,l){n(l,4,0,l.parent.context.$implicit.name)})}function S(n){return t.Jb(0,[(n()(),t.pb(0,0,null,null,2,\"div\",[],null,null,null,null,null)),(n()(),t.gb(16777216,null,null,1,null,C)),t.ob(2,16384,null,0,w.k,[t.O,t.L],{ngIf:[0,\"ngIf\"]},null)],function(n,l){var e=l.component,t=(l.context.$implicit.name.toLowerCase().includes(e.searchService.searchInput.toLowerCase())||\"\"==e.searchService.searchInput)&&(\"showall\"==e.selectedDepartment||e.selectedDepartment==l.context.$implicit.group);n(l,2,0,t)},null)}function D(n){return t.Jb(0,[t.Bb(0,w.t,[]),(n()(),t.pb(1,0,null,null,26,\"ion-content\",[[\"padding\",\"\"],[\"style\",\"position: relative;\"]],null,null,null,m.Q,m.j)),t.ob(2,49152,null,0,a.u,[t.h,t.k],null,null),(n()(),t.pb(3,0,null,0,15,\"ion-row\",[],null,null,null,m.cb,m.v)),t.ob(4,49152,null,0,a.ib,[t.h,t.k],null,null),(n()(),t.pb(5,0,null,0,13,\"ion-item\",[[\"class\",\"filter-row\"]],null,null,null,m.X,m.q)),t.ob(6,49152,null,0,a.H,[t.h,t.k],null,null),(n()(),t.pb(7,0,null,0,0,\"img\",[[\"class\",\"filter-icon\"],[\"src\",\"assets/imgs/settings_icon.png\"]],null,null,null,null,null)),(n()(),t.pb(8,0,null,0,1,\"label\",[],null,null,null,null,null)),(n()(),t.Hb(-1,null,[\"Filter\"])),(n()(),t.pb(10,0,null,0,8,\"ion-select\",[[\"class\",\"filter-select\"]],[[2,\"ng-untouched\",null],[2,\"ng-touched\",null],[2,\"ng-pristine\",null],[2,\"ng-dirty\",null],[2,\"ng-valid\",null],[2,\"ng-invalid\",null],[2,\"ng-pending\",null]],[[null,\"ngModelChange\"],[null,\"ionChange\"],[null,\"ionBlur\"]],function(n,l,e){var o=!0,i=n.component;return\"ionBlur\"===l&&(o=!1!==t.zb(n,11)._handleBlurEvent()&&o),\"ionChange\"===l&&(o=!1!==t.zb(n,11)._handleChangeEvent(e.target.value)&&o),\"ngModelChange\"===l&&(o=!1!==(i.selectedDepartment=e)&&o),\"ionChange\"===l&&(o=!1!==i.filterDownloadListByGroup()&&o),o},m.fb,m.x)),t.ob(11,16384,null,0,a.Lb,[t.k],null,null),t.Eb(1024,null,y.i,function(n){return[n]},[a.Lb]),t.ob(13,671744,null,0,y.m,[[8,null],[8,null],[8,null],[6,y.i]],{model:[0,\"model\"]},{update:\"ngModelChange\"}),t.Eb(2048,null,y.j,null,[y.m]),t.ob(15,16384,null,0,y.k,[[4,y.j]],null,null),t.ob(16,49152,null,0,a.mb,[t.h,t.k],null,null),(n()(),t.gb(16777216,null,0,1,null,x)),t.ob(18,278528,null,0,w.j,[t.O,t.L,t.s],{ngForOf:[0,\"ngForOf\"]},null),(n()(),t.pb(19,0,null,0,3,\"ion-list\",[],null,null,null,m.Z,m.s)),t.ob(20,49152,null,0,a.O,[t.h,t.k],null,null),(n()(),t.gb(16777216,null,0,1,null,S)),t.ob(22,278528,null,0,w.j,[t.O,t.L,t.s],{ngForOf:[0,\"ngForOf\"]},null),(n()(),t.pb(23,0,null,0,4,\"ion-fab-button\",[[\"class\",\"upload-fab\"],[\"size\",\"small\"]],null,[[null,\"click\"]],function(n,l,e){var t=!0;return\"click\"===l&&(t=!1!==n.component.upload()&&t),t},m.S,m.l)),t.ob(24,49152,null,0,a.x,[t.h,t.k],{size:[0,\"size\"]},null),(n()(),t.pb(25,0,null,0,0,\"input\",[[\"class\",\"hidden-input\"],[\"name\",\"\"],[\"style\",\"display: none;\"],[\"type\",\"file\"]],null,null,null,null,null)),(n()(),t.pb(26,0,null,0,1,\"ion-icon\",[[\"name\",\"add\"]],null,null,null,m.V,m.o)),t.ob(27,49152,null,0,a.C,[t.h,t.k],{name:[0,\"name\"]},null)],function(n,l){var e=l.component;n(l,13,0,e.selectedDepartment),n(l,18,0,e.groups),n(l,22,0,e.storageService.files),n(l,24,0,\"small\"),n(l,27,0,\"add\")},function(n,l){n(l,10,0,t.zb(l,15).ngClassUntouched,t.zb(l,15).ngClassTouched,t.zb(l,15).ngClassPristine,t.zb(l,15).ngClassDirty,t.zb(l,15).ngClassValid,t.zb(l,15).ngClassInvalid,t.zb(l,15).ngClassPending)})}function O(n){return t.Jb(0,[(n()(),t.pb(0,0,null,null,1,\"app-file-cabinet\",[],null,null,null,D,k)),t.ob(1,114688,null,0,h,[o.a,i.a,b,d.a,a.a],null,null)],function(n,l){n(l,1,0)},null)}var F=t.lb(\"app-file-cabinet\",h,O,{},{},[]),I=e(\"ZYCi\");e.d(l,\"FileCabinetPageModuleNgFactory\",function(){return z});var z=t.mb(g,[],function(n){return t.wb([t.xb(512,t.j,t.bb,[[8,[v.a,F]],[3,t.j],t.x]),t.xb(4608,w.m,w.l,[t.u,[2,w.y]]),t.xb(4608,y.r,y.r,[]),t.xb(4608,a.b,a.b,[t.z,t.g]),t.xb(4608,a.Hb,a.Hb,[a.b,t.j,t.q]),t.xb(4608,a.Kb,a.Kb,[a.b,t.j,t.q]),t.xb(1073742336,w.b,w.b,[]),t.xb(1073742336,y.p,y.p,[]),t.xb(1073742336,y.h,y.h,[]),t.xb(1073742336,a.Db,a.Db,[]),t.xb(1073742336,I.n,I.n,[[2,I.t],[2,I.m]]),t.xb(1073742336,g,g,[]),t.xb(1024,I.k,function(){return[[{path:\"\",component:h}]]},[])])})}}]);","extractedComments":[]}