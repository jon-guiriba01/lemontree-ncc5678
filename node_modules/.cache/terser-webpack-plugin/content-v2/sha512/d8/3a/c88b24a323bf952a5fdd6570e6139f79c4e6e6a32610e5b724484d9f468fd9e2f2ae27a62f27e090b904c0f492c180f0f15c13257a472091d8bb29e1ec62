{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{JACw:function(n,l,e){\"use strict\";e.r(l);var o=e(\"CcnG\"),t=e(\"lGQG\"),i=e(\"JHBR\"),u=e(\"tct4\"),a=e(\"2WpN\"),c=function(){return(c=Object.assign||function(n){for(var l,e=1,o=arguments.length;e<o;e++)for(var t in l=arguments[e])Object.prototype.hasOwnProperty.call(l,t)&&(n[t]=l[t]);return n}).apply(this,arguments)},r=function(){function n(n,l){var e=this;this.afStorage=n,this.afs=l,this.files=[],this.filesCollection=this.afs.collection(\"files\"),this.filesCollection.snapshotChanges().subscribe(function(n){for(var l=[],o=0,t=n;o<t.length;o++){var i=t[o],u=c({},i.payload.doc.data());u.id=i.payload.doc.id,l.push(u)}e.files=l,console.log(\"this.files\",e.files)})}return n.prototype.uploadFile=function(n,l){var e=this;void 0===l&&(l=\"filecabinet\"),console.log(\"[uploadFile]\",n),console.log(\"-path\",l);var o=l+\"/\"+n.name,t=this.afStorage.ref(o),i=this.afStorage.upload(o,n);i.percentageChanges(),i.snapshotChanges().pipe(Object(a.a)(function(){return i=e,void 0,a=function(){var e=this;return function(n,l){var e,o,t,i,u={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(e)throw new TypeError(\"Generator is already executing.\");for(;u;)try{if(e=1,o&&(t=2&i[0]?o.return:i[0]?o.throw||((t=o.return)&&t.call(o),0):o.next)&&!(t=t.call(o,i[1])).done)return t;switch(o=0,t&&(i=[2&i[0],t.value]),i[0]){case 0:case 1:t=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,o=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(t=(t=u.trys).length>0&&t[t.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!t||i[1]>t[0]&&i[1]<t[3])){u.label=i[1];break}if(6===i[0]&&u.label<t[1]){u.label=t[1],t=i;break}if(t&&u.label<t[2]){u.label=t[2],u.ops.push(i);break}t[2]&&u.ops.pop(),u.trys.pop();continue}i=l.call(n,u)}catch(a){i=[6,a],o=0}finally{e=t=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}(this,function(i){return console.log(\"-finalize\",l),t.getDownloadURL().subscribe(function(l){e.filesCollection.add({name:n.name,path:o,downloadURL:l})}),[2]})},new((u=void 0)||(u=Promise))(function(n,l){function e(n){try{t(a.next(n))}catch(e){l(e)}}function o(n){try{t(a.throw(n))}catch(e){l(e)}}function t(l){l.done?n(l.value):new u(function(n){n(l.value)}).then(e,o)}t((a=a.apply(i,[])).next())});var i,u,a})).subscribe(function(n){console.log(\"afUploadTask\",n)})},n.prototype.downloadFile=function(n){console.log(\"[downloadFile]\",n);var l=document.createElement(\"a\");l.href=n.downloadURL,l.setAttribute(\"download\",name),l.click()},n.ngInjectableDef=o.S({factory:function(){return new n(o.W(i.a),o.W(u.a))},token:n,providedIn:\"root\"}),n}(),s=e(\"EVdn\"),p=e(\"l3hs\"),f=function(){function n(n,l,e,o){this.authService=n,this.afStorage=l,this.storageService=e,this.searchService=o,this.files=[],this.loadGapi().then(function(n){console.log(n)})}return n.prototype.ngOnInit=function(){},n.prototype.upload=function(){var n=this;s(\".hidden-input\").click(),s(\".hidden-input\").change(function(l){l.stopImmediatePropagation();var e=l.target.files[0];console.log('The file \"'+e.name+'\" has been selected.'),n.storageService.uploadFile(e)})},n.prototype.loadGapi=function(){return new Promise(function(n,l){gapi.load(\"client:auth2\",function(l){gapi.client.init({apiKey:\"AIzaSyBO3-f5lc3BYJGBNdlYaEz0odwcxefP0Yc\",clientId:\"694548309780-p7pvh160hh62p2dpma7822pv83hsd1js.apps.googleusercontent.com\",scope:\"https://www.googleapis.com/auth/drive\",discoveryDocs:[\"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\",\"https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest\"]}).then(function(){n(gapi);var l=gapi.auth2.getAuthInstance();console.log(\"gAuth\",l),console.log(\"gapi\",gapi);var e=gapi.client.drive.files.list();console.log(\"test \",e),l.isSignedIn.listen(function(n){console.log(\"listen gapi\",n)})})})})},n.prototype.onClickDownload=function(n,l){this.storageService.downloadFile(n)},n}(),b=function(){return function(){}}(),d=e(\"pMnS\"),h=e(\"oBZk\"),g=e(\"ZZ/e\"),v=e(\"Ip0R\"),w=o.nb({encapsulation:0,styles:[[\".upload-fab[_ngcontent-%COMP%]{position:absolute;bottom:5px;right:5px}\"]],data:{}});function m(n){return o.Jb(0,[(n()(),o.pb(0,0,null,null,8,\"ion-item\",[],null,null,null,h.R,h.n)),o.ob(1,49152,null,0,g.G,[o.h,o.k],null,null),(n()(),o.pb(2,0,null,0,2,\"ion-label\",[],null,null,null,h.S,h.o)),o.ob(3,49152,null,0,g.M,[o.h,o.k],null,null),(n()(),o.Hb(4,0,[\"\",\"\"])),(n()(),o.pb(5,0,null,0,3,\"ion-button\",[[\"fill\",\"clear\"]],null,[[null,\"click\"]],function(n,l,e){var o=!0;return\"click\"===l&&(o=!1!==n.component.onClickDownload(n.parent.context.$implicit,e)&&o),o},h.G,h.c)),o.ob(6,49152,null,0,g.j,[o.h,o.k],{fill:[0,\"fill\"]},null),(n()(),o.pb(7,0,null,0,1,\"ion-icon\",[[\"name\",\"cloud-download\"]],null,null,null,h.P,h.l)),o.ob(8,49152,null,0,g.B,[o.h,o.k],{name:[0,\"name\"]},null)],function(n,l){n(l,6,0,\"clear\"),n(l,8,0,\"cloud-download\")},function(n,l){n(l,4,0,l.parent.context.$implicit.name)})}function y(n){return o.Jb(0,[(n()(),o.pb(0,0,null,null,2,\"div\",[],null,null,null,null,null)),(n()(),o.gb(16777216,null,null,1,null,m)),o.ob(2,16384,null,0,v.k,[o.O,o.L],{ngIf:[0,\"ngIf\"]},null)],function(n,l){var e=l.component,o=l.context.$implicit.name.toLowerCase().includes(e.searchService.searchInput.toLowerCase())||\"\"==e.searchService.searchInput;n(l,2,0,o)},null)}function k(n){return o.Jb(0,[(n()(),o.pb(0,0,null,null,10,\"ion-content\",[[\"padding\",\"\"],[\"style\",\"position: relative;\"]],null,null,null,h.L,h.h)),o.ob(1,49152,null,0,g.t,[o.h,o.k],null,null),(n()(),o.pb(2,0,null,0,3,\"ion-list\",[],null,null,null,h.T,h.p)),o.ob(3,49152,null,0,g.N,[o.h,o.k],null,null),(n()(),o.gb(16777216,null,0,1,null,y)),o.ob(5,278528,null,0,v.j,[o.O,o.L,o.s],{ngForOf:[0,\"ngForOf\"]},null),(n()(),o.pb(6,0,null,0,4,\"ion-fab-button\",[[\"class\",\"upload-fab\"],[\"size\",\"small\"]],null,[[null,\"click\"]],function(n,l,e){var o=!0;return\"click\"===l&&(o=!1!==n.component.upload()&&o),o},h.M,h.i)),o.ob(7,49152,null,0,g.w,[o.h,o.k],{size:[0,\"size\"]},null),(n()(),o.pb(8,0,null,0,0,\"input\",[[\"class\",\"hidden-input\"],[\"name\",\"\"],[\"style\",\"display: none;\"],[\"type\",\"file\"]],null,null,null,null,null)),(n()(),o.pb(9,0,null,0,1,\"ion-icon\",[[\"name\",\"add-circle-outline\"]],null,null,null,h.P,h.l)),o.ob(10,49152,null,0,g.B,[o.h,o.k],{name:[0,\"name\"]},null)],function(n,l){n(l,5,0,l.component.storageService.files),n(l,7,0,\"small\"),n(l,10,0,\"add-circle-outline\")},null)}function x(n){return o.Jb(0,[(n()(),o.pb(0,0,null,null,1,\"app-file-cabinet\",[],null,null,null,k,w)),o.ob(1,114688,null,0,f,[t.a,i.a,r,p.a],null,null)],function(n,l){n(l,1,0)},null)}var S=o.lb(\"app-file-cabinet\",f,x,{},{},[]),C=e(\"gIcY\"),I=e(\"ZYCi\");e.d(l,\"FileCabinetPageModuleNgFactory\",function(){return j});var j=o.mb(b,[],function(n){return o.wb([o.xb(512,o.j,o.bb,[[8,[d.a,S]],[3,o.j],o.x]),o.xb(4608,v.m,v.l,[o.u,[2,v.x]]),o.xb(4608,C.k,C.k,[]),o.xb(4608,g.a,g.a,[o.z,o.g]),o.xb(4608,g.Gb,g.Gb,[g.a,o.j,o.q]),o.xb(4608,g.Jb,g.Jb,[g.a,o.j,o.q]),o.xb(1073742336,v.b,v.b,[]),o.xb(1073742336,C.i,C.i,[]),o.xb(1073742336,C.b,C.b,[]),o.xb(1073742336,g.Cb,g.Cb,[]),o.xb(1073742336,I.n,I.n,[[2,I.t],[2,I.m]]),o.xb(1073742336,b,b,[]),o.xb(1024,I.k,function(){return[[{path:\"\",component:f}]]},[])])})}}]);","extractedComments":[]}